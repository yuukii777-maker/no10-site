/* ===== scoped variables & base ===== */
.stage{
  --txt:#e9eef7;
  --txt-d:#b9c3d6;
  --panel-border: rgba(255,255,255,.08);
  --panel-shadow: 0 16px 60px rgba(0,0,0,.35);
  --panel-bg-1: rgba(10,12,18,.42);
  --panel-bg-2: rgba(10,12,18,.28);

  position:relative;
  isolation:isolate;
  min-height:200vh;
  overflow-x:hidden;
  background:
    radial-gradient(1200px 600px at 50% 10%, rgba(255,255,255,.08), transparent 60%),
    linear-gradient(#0a1020, #0a1322 45%, #08101e);
  color:var(--txt);
}

/* ===== background layers ===== */
.bg{
  position:fixed;
  inset:0;
  z-index:0;
  background-image:url("/notes3d/ocean_bg.png");
  background-size:cover;
  background-position:center;
  will-change:transform;
  transform:translateZ(0);
  pointer-events:none;
}

.rays{
  position:fixed;
  inset:0;
  z-index:1;
  pointer-events:none;
  background-image:url("/notes3d/light_rays.png");
  background-repeat:no-repeat;
  background-position:50% -10%;
  background-size:min(1400px, 90vmin) auto;
  mix-blend-mode:screen;
  opacity:.45;
  filter:blur(.2px);
  animation:notesRays 16s linear infinite;
}
@keyframes notesRays {
  from{ transform:translate3d(-2%,0,0) }
  to  { transform:translate3d( 2%,0,0) }
}

.clouds{
  position:fixed;
  inset:0;
  z-index:2;
  pointer-events:none;
  background-image:url("/notes3d/cloud_soft.png");
  background-repeat:repeat-x;
  background-position:0% 12%;
  background-size:auto 38vmin;
  opacity:.8;
  animation:notesClouds 90s linear infinite;
  transform:translate3d(0, calc(var(--scroll, 0) * -6vh), 0);
}
@keyframes notesClouds {
  from{ background-position:0% 12% }
  to  { background-position:200% 12% }
}

/* ===== 3D canvas ===== */
.canvas3d{
  position:fixed;
  inset:0;
  z-index:3;
  width:100%;
  height:100%;
  display:block;
  pointer-events:none;
}

/* ===== hero content ===== */
.hero{
  position:relative;
  z-index:4;
  padding-top:min(22vh, 180px);
  padding-bottom:48px;
  text-align:center;
}

.hero h1{
  font-family:"Cinzel",serif;
  font-weight:900;
  letter-spacing:.06em;
  font-size:clamp(28px, 7vw, 64px);
  margin:0 0 16px;
  text-shadow:0 10px 40px rgba(0,0,0,.45);
}

.hero p{
  color:var(--txt-d);
  font-size:clamp(14px, 2.2vw, 18px);
  margin:0 auto 24px;
  max-width:820px;
}

.cta{
  display:flex;
  gap:12px;
  justify-content:center;
}

.btn, .btnGhost{
  display:inline-block;
  padding:12px 22px;
  border-radius:14px;
  font-weight:700;
  letter-spacing:.04em;
  text-decoration:none;
  transition:transform .2s ease, box-shadow .2s ease, opacity .2s ease;
}

.btn{
  background:#3ea6ff;
  color:#05121f;
  box-shadow:0 8px 24px rgba(62,166,255,.35);
}

.btnGhost{
  border:1px solid rgba(255,255,255,.3);
  color:var(--txt);
}

.btn:hover, .btnGhost:hover{
  transform:translateY(-1px);
}

/* ===== glass panel ===== */
.glass{
  position:relative;
  z-index:5;
  width:min(1060px, 92vw);
  margin:0 auto;
  padding:22px clamp(16px, 4vw, 28px);
  border-radius:18px;
  background: linear-gradient(180deg, var(--panel-bg-1), var(--panel-bg-2));
  border:1px solid var(--panel-border);
  box-shadow: var(--panel-shadow);
  backdrop-filter: blur(10px) saturate(120%);
  -webkit-backdrop-filter: blur(10px) saturate(120%);
  color:#f2f4f8;
  text-align:left;
}

@supports not ((-webkit-backdrop-filter: blur(1px)) or (backdrop-filter: blur(1px))){
  .glass{ background: rgba(10,12,18,.62); }
}

/* ===== FAQ styles ===== */
.faq{
  margin:0;
  padding:0;
  line-height:1.9;
}
.qa + .qa{ margin-top:16px; }

.qa dt{
  font-weight:800;
  margin:0 0 6px;
  letter-spacing:.02em;
  text-shadow:0 2px 10px rgba(0,0,0,.35);
}
.qa dd{
  margin:0;
  color:var(--txt);
  opacity:.96;
  text-shadow:0 1px 8px rgba(0,0,0,.25);
}
.qa small{
  color:var(--txt-d);
  font-size:.92em;
}

/* 装飾ライン */
.glass::before{
  content:"";
  position:absolute;
  inset:0;
  border-radius:inherit;
  pointer-events:none;
  background:
    radial-gradient(40% 25% at 50% 0%, rgba(255,255,255,.08), transparent 70%),
    linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,0));
  mix-blend-mode:screen;
}

/* ===== filler ===== */
.fill{
  height:140vh;
  display:grid;
  place-items:center;
}
.fill article{
  width:min(900px, 86vw);
  padding:32px;
  border-radius:18px;
  background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
  box-shadow:0 12px 44px rgba(0,0,0,.25);
  backdrop-filter:blur(6px);
}

/* ===== motion preferences ===== */
@media (prefers-reduced-motion: reduce){
  .rays, .clouds{ animation: none !important; }
}

/* ===== scroll-driven animation ===== */
@supports (animation-timeline: scroll()) {
  .clouds{
    animation:
      notesClouds 90s linear infinite,
      notesCloudY 1 linear both;
    animation-timeline: scroll();
    animation-range: 0% 100%;
  }
  @keyframes notesCloudY {
    to{ transform:translate3d(0, -6vh, 0) }
  }
}

/* ===== responsive tweaks ===== */
@media (max-width: 640px){
  .hero{ padding-top: 18vh; padding-bottom: 36px; }
  .glass{
    width: min(100%, 94vw);
    padding: 16px 14px;
    background: rgba(10,12,18,.58);
    backdrop-filter: blur(12px) saturate(120%);
    -webkit-backdrop-filter: blur(12px) saturate(120%);
  }
  .qa + .qa{ margin-top:14px; }
}

/* ===== ここまであなたの既存CSS ===== */

/* ========== BGM トグル（左下の小さな丸ボタン） ========== */
.bgm {
  position: fixed;
  left: 14px;
  bottom: 14px;
  z-index: 1100;
  width: 44px;
  height: 44px;
  border-radius: 999px;
  display: grid;
  place-items: center;
  font-weight: 900;
  letter-spacing: .02em;
  background: rgba(255,255,255,.14);
  color: #0b1220;
  border: 1px solid rgba(255,255,255,.35);
  box-shadow: 0 8px 24px rgba(0,0,0,.25);
  backdrop-filter: blur(8px) saturate(120%);
  -webkit-backdrop-filter: blur(8px) saturate(120%);
  cursor: pointer;
  user-select: none;
  transition: transform .15s ease, opacity .15s ease, background .2s ease;
}
.bgm:hover { transform: translateY(-1px); }
.bgm:active { transform: translateY(1px); }

/* 状態で色味を少しだけ変える（視覚ヒント） */
.bgmOn  { background: rgba(255,255,255,.22); }
.bgmOff { background: rgba(255,255,255,.10); }
